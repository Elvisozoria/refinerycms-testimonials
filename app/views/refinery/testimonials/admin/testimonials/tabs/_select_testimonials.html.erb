<%
  testimonials = Refinery::Testimonials::Testimonial.all
  header = tag.h3 "Select Testimonials"
  if testimonials.count.zero?
    selection = 'No Testimonials'
  else
    testimonial_options = testimonials.map { |test| [test.select_option, test.id, { class: test.select_option_classes }] }
    option_tags = options_for_select(testimonial_options, @page.testimonials)
    select_classes = %w[multiselect testimonials]

    selection = select_tag 'page["testimonial_ids"]', option_tags,
                           { multiple: true, name: 'page[testimonial_ids][]',
                             class: select_classes,
                             id: :testimonial_multiselect }
  end

  content = tag.div header << selection, class: 'wym_skin_refinery page_part', id: 'page_testimonial_selector'
%>
<section class="testimonials">
  <h3 class="highlight">Select testimonials to be shown on this page</h3>

  <%= content %>
</section>
